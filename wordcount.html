<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>wordcount</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="F# DSL and runtime for Storm topologies"/>
    <meta name="author" content="Eugene Tolmachev"/>

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"/>

    <link type="text/css" rel="stylesheet" href="https://prolucid.github.io/FsShelter/content/style.css" />
    <link rel="icon"
            type="image/png"
            href="https://prolucid.github.io/FsShelter/img/logo.png" />
    <script type="text/javascript" src="https://prolucid.github.io/FsShelter/content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="https://prolucid.github.io">prolucid</a></li>
          <li><a href="http://fsharp.org">fsharp.org</a></li>
          <li><a href="http://github.com/Prolucid/FsShelter">github page</a></li>
        </ul>
        <h3 class="muted"><a href="https://prolucid.github.io/FsShelter/index.html">FsShelter</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<h2><a name="Defining-the-schema" class="anchor" href="#Defining-the-schema">Defining the schema</a></h2>
<p>FsShelter uses F# discriminated unions to statically type streams:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// data schema for the topology, every case is a unqiue stream</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="t">Schema</span> <span class="o">=</span> 
    | <span onmouseout="hideTip(event, 'fs3', 4)" onmouseover="showTip(event, 'fs3', 4)" class="p">Sentence</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs3', 5)" onmouseover="showTip(event, 'fs3', 5)" class="t">string</span>
    | <span onmouseout="hideTip(event, 'fs3', 6)" onmouseover="showTip(event, 'fs3', 6)" class="p">Word</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs3', 7)" onmouseover="showTip(event, 'fs3', 7)" class="t">string</span>
    | <span onmouseout="hideTip(event, 'fs3', 8)" onmouseover="showTip(event, 'fs3', 8)" class="p">WordCount</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs3', 9)" onmouseover="showTip(event, 'fs3', 9)" class="t">string</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs3', 10)" onmouseover="showTip(event, 'fs3', 10)" class="t">int64</span>
</code></pre></td>
</tr>
</table>
<h2><a name="Defining-unreliable-spouts" class="anchor" href="#Defining-unreliable-spouts">Defining unreliable spouts</a></h2>
<p>FsShelter spouts can be implemented as "reliable" or "unreliable".
Either implementation is a single function, returning an <code>async option</code>, where <code>None</code> indicates there's nothing to emit from this spout at this moment:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// sentences spout - feeds messages into the topology</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 11)" onmouseover="showTip(event, 'fs3', 11)" class="f">sentences</span> <span onmouseout="hideTip(event, 'fs3', 12)" onmouseover="showTip(event, 'fs3', 12)" class="f">source</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs3', 13)" onmouseover="showTip(event, 'fs3', 13)" class="f">source</span>() <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs3', 14)" onmouseover="showTip(event, 'fs3', 14)" class="p">Sentence</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs3', 15)" onmouseover="showTip(event, 'fs3', 15)" class="p">Some</span>
</code></pre></td>
</tr>
</table>
<h2><a name="Defining-bolts" class="anchor" href="#Defining-bolts">Defining bolts</a></h2>
<p>A couple of examples of FsShelter bolts that read a tuple and emit another one:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// split bolt - consumes sentences and emits words</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 16)" onmouseover="showTip(event, 'fs3', 16)" class="f">splitIntoWords</span> (<span onmouseout="hideTip(event, 'fs3', 17)" onmouseover="showTip(event, 'fs3', 17)" class="i">input</span>, <span onmouseout="hideTip(event, 'fs3', 18)" onmouseover="showTip(event, 'fs3', 18)" class="f">emit</span>) <span class="o">=</span> 
    <span class="k">match</span> <span onmouseout="hideTip(event, 'fs3', 19)" onmouseover="showTip(event, 'fs3', 19)" class="i">input</span> <span class="k">with</span>
    | <span onmouseout="hideTip(event, 'fs3', 20)" onmouseover="showTip(event, 'fs3', 20)" class="p">Sentence</span> <span onmouseout="hideTip(event, 'fs4', 21)" onmouseover="showTip(event, 'fs4', 21)" class="i">s</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs4', 22)" onmouseover="showTip(event, 'fs4', 22)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs5', 23)" onmouseover="showTip(event, 'fs5', 23)" class="f">Split</span>([|<span class="s">&#39; &#39;</span>|],<span onmouseout="hideTip(event, 'fs3', 24)" onmouseover="showTip(event, 'fs3', 24)" class="t">StringSplitOptions</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs6', 25)" onmouseover="showTip(event, 'fs6', 25)" class="i">RemoveEmptyEntries</span>) 
                    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs3', 26)" onmouseover="showTip(event, 'fs3', 26)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 27)" onmouseover="showTip(event, 'fs7', 27)" class="f">map</span> <span onmouseout="hideTip(event, 'fs3', 28)" onmouseover="showTip(event, 'fs3', 28)" class="p">Word</span> 
                    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs3', 29)" onmouseover="showTip(event, 'fs3', 29)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs8', 30)" onmouseover="showTip(event, 'fs8', 30)" class="f">iter</span> <span onmouseout="hideTip(event, 'fs3', 31)" onmouseover="showTip(event, 'fs3', 31)" class="f">emit</span>
    | _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs3', 32)" onmouseover="showTip(event, 'fs3', 32)" class="f">failwithf</span> <span class="s">&quot;unexpected input: </span><span class="pf">%A</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs3', 33)" onmouseover="showTip(event, 'fs3', 33)" class="i">input</span>

<span class="c">// count words bolt </span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 34)" onmouseover="showTip(event, 'fs3', 34)" class="f">countWords</span> (<span onmouseout="hideTip(event, 'fs3', 35)" onmouseover="showTip(event, 'fs3', 35)" class="i">input</span>, <span onmouseout="hideTip(event, 'fs3', 36)" onmouseover="showTip(event, 'fs3', 36)" class="f">increment</span>, <span onmouseout="hideTip(event, 'fs3', 37)" onmouseover="showTip(event, 'fs3', 37)" class="f">emit</span>) <span class="o">=</span> 
    <span class="k">match</span> <span onmouseout="hideTip(event, 'fs3', 38)" onmouseover="showTip(event, 'fs3', 38)" class="i">input</span> <span class="k">with</span>
    | <span onmouseout="hideTip(event, 'fs3', 39)" onmouseover="showTip(event, 'fs3', 39)" class="p">Word</span> <span onmouseout="hideTip(event, 'fs3', 40)" onmouseover="showTip(event, 'fs3', 40)" class="i">word</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs3', 41)" onmouseover="showTip(event, 'fs3', 41)" class="p">WordCount</span> (<span onmouseout="hideTip(event, 'fs3', 42)" onmouseover="showTip(event, 'fs3', 42)" class="i">word</span>, <span onmouseout="hideTip(event, 'fs3', 43)" onmouseover="showTip(event, 'fs3', 43)" class="f">increment</span> <span onmouseout="hideTip(event, 'fs3', 44)" onmouseover="showTip(event, 'fs3', 44)" class="i">word</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs3', 45)" onmouseover="showTip(event, 'fs3', 45)" class="f">emit</span>
    | _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs3', 46)" onmouseover="showTip(event, 'fs3', 46)" class="f">failwithf</span> <span class="s">&quot;unexpected input: </span><span class="pf">%A</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs3', 47)" onmouseover="showTip(event, 'fs3', 47)" class="i">input</span>
</code></pre></td>
</tr>
</table>
<p>And a terminating bolt that reads a tuple, but doesn't emit anything:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// log word count - terminating bolt </span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 48)" onmouseover="showTip(event, 'fs3', 48)" class="f">logResult</span> (<span onmouseout="hideTip(event, 'fs3', 49)" onmouseover="showTip(event, 'fs3', 49)" class="f">log</span>, <span onmouseout="hideTip(event, 'fs3', 50)" onmouseover="showTip(event, 'fs3', 50)" class="i">input</span>) <span class="o">=</span> 
    <span class="k">match</span> <span onmouseout="hideTip(event, 'fs3', 51)" onmouseover="showTip(event, 'fs3', 51)" class="i">input</span> <span class="k">with</span>
    | <span onmouseout="hideTip(event, 'fs3', 52)" onmouseover="showTip(event, 'fs3', 52)" class="p">WordCount</span> (<span onmouseout="hideTip(event, 'fs3', 53)" onmouseover="showTip(event, 'fs3', 53)" class="i">word</span>,<span onmouseout="hideTip(event, 'fs3', 54)" onmouseover="showTip(event, 'fs3', 54)" class="i">count</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs3', 55)" onmouseover="showTip(event, 'fs3', 55)" class="f">log</span> (<span onmouseout="hideTip(event, 'fs3', 56)" onmouseover="showTip(event, 'fs3', 56)" class="f">sprintf</span> <span class="s">&quot;</span><span class="pf">%s</span><span class="s">: </span><span class="pf">%d</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs3', 57)" onmouseover="showTip(event, 'fs3', 57)" class="i">word</span> <span onmouseout="hideTip(event, 'fs3', 58)" onmouseover="showTip(event, 'fs3', 58)" class="i">count</span>)
    | _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs3', 59)" onmouseover="showTip(event, 'fs3', 59)" class="f">failwithf</span> <span class="s">&quot;unexpected input: </span><span class="pf">%A</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs3', 60)" onmouseover="showTip(event, 'fs3', 60)" class="i">input</span>
</code></pre></td>
</tr>
</table>
<p>We will pass these implementations into the component functions when we put things together in a topology definition.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 61)" onmouseover="showTip(event, 'fs3', 61)" class="f">source</span> <span class="o">=</span> 
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 62)" onmouseover="showTip(event, 'fs3', 62)" class="i">rnd</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, 'fs3', 63)" onmouseover="showTip(event, 'fs3', 63)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs9', 64)" onmouseover="showTip(event, 'fs9', 64)" class="t">Random</span>()
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 65)" onmouseover="showTip(event, 'fs3', 65)" class="i">sentences</span> <span class="o">=</span> [ <span class="s">&quot;the cow jumped over the moon&quot;</span>
                      <span class="s">&quot;an apple a day keeps the doctor away&quot;</span>
                      <span class="s">&quot;four score and seven years ago&quot;</span>
                      <span class="s">&quot;snow white and the seven dwarfs&quot;</span>
                      <span class="s">&quot;i am at two with nature&quot;</span> ]

    <span class="k">fun</span> () <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs3', 66)" onmouseover="showTip(event, 'fs3', 66)" class="i">sentences</span><span class="o">.</span>[ <span onmouseout="hideTip(event, 'fs3', 67)" onmouseover="showTip(event, 'fs3', 67)" class="i">rnd</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs10', 68)" onmouseover="showTip(event, 'fs10', 68)" class="f">Next</span>(<span class="n">0</span>, <span onmouseout="hideTip(event, 'fs3', 69)" onmouseover="showTip(event, 'fs3', 69)" class="i">sentences</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs11', 70)" onmouseover="showTip(event, 'fs11', 70)" class="i">Length</span>) ]

<span class="c">// increment word count and return new value</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 71)" onmouseover="showTip(event, 'fs3', 71)" class="f">increment</span> <span class="o">=</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 72)" onmouseover="showTip(event, 'fs3', 72)" class="i">cache</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs3', 73)" onmouseover="showTip(event, 'fs3', 73)" class="i">Collections</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 74)" onmouseover="showTip(event, 'fs12', 74)" class="i">Concurrent</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs13', 75)" onmouseover="showTip(event, 'fs13', 75)" class="t">ConcurrentDictionary</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs3', 76)" onmouseover="showTip(event, 'fs3', 76)" class="t">string</span>,<span onmouseout="hideTip(event, 'fs3', 77)" onmouseover="showTip(event, 'fs3', 77)" class="t">int64</span> <span onmouseout="hideTip(event, 'fs3', 78)" onmouseover="showTip(event, 'fs3', 78)" class="t">ref</span><span class="o">&gt;</span>()
    <span class="k">fun</span> <span onmouseout="hideTip(event, 'fs3', 79)" onmouseover="showTip(event, 'fs3', 79)" class="i">word</span> <span class="k">-&gt;</span> 
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs14', 80)" onmouseover="showTip(event, 'fs14', 80)" class="v">c</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs3', 81)" onmouseover="showTip(event, 'fs3', 81)" class="i">cache</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs15', 82)" onmouseover="showTip(event, 'fs15', 82)" class="f">GetOrAdd</span>(<span onmouseout="hideTip(event, 'fs3', 83)" onmouseover="showTip(event, 'fs3', 83)" class="i">word</span>, <span onmouseout="hideTip(event, 'fs3', 84)" onmouseover="showTip(event, 'fs3', 84)" class="f">ref</span> <span class="n">0L</span>) 
        <span onmouseout="hideTip(event, 'fs3', 85)" onmouseover="showTip(event, 'fs3', 85)" class="i">Threading</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs16', 86)" onmouseover="showTip(event, 'fs16', 86)" class="t">Interlocked</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 87)" onmouseover="showTip(event, 'fs17', 87)" class="f">Increment</span> <span class="o">&amp;</span><span onmouseout="hideTip(event, 'fs14', 88)" onmouseover="showTip(event, 'fs14', 88)" class="v">c</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 89)" onmouseover="showTip(event, 'fs18', 89)" class="v">contents</span>
</code></pre></td>
</tr>
</table>
<h2><a name="Using-F-DSL-to-define-a-topology" class="anchor" href="#Using-F-DSL-to-define-a-topology">Using F# DSL to define a topology</a></h2>
<p>A typical (event-streaming) Storm topology is a graph of spouts and bolts connected via streams that can be defined via a <code>topology</code> computation expression:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs3', 90)" onmouseover="showTip(event, 'fs3', 90)" class="i">FsShelter</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs19', 91)" onmouseover="showTip(event, 'fs19', 91)" class="i">DSL</span>
<span class="prep">#nowarn</span> <span class="s">&quot;25&quot;</span> <span class="c">// for stream grouping expressions</span>

<span class="c">//define the storm topology</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 92)" onmouseover="showTip(event, 'fs3', 92)" class="i">sampleTopology</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs3', 93)" onmouseover="showTip(event, 'fs3', 93)" class="f">topology</span> <span class="s">&quot;WordCount&quot;</span> { 
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 94)" onmouseover="showTip(event, 'fs3', 94)" class="i">sentencesSpout</span> <span class="o">=</span> 
            <span onmouseout="hideTip(event, 'fs3', 95)" onmouseover="showTip(event, 'fs3', 95)" class="f">sentences</span>
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs3', 96)" onmouseover="showTip(event, 'fs3', 96)" class="t">Spout</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 97)" onmouseover="showTip(event, 'fs20', 97)" class="f">runUnreliable</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs3', 98)" onmouseover="showTip(event, 'fs3', 98)" class="f">log</span> <span onmouseout="hideTip(event, 'fs3', 99)" onmouseover="showTip(event, 'fs3', 99)" class="i">cfg</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs3', 100)" onmouseover="showTip(event, 'fs3', 100)" class="f">source</span>)  <span class="c">// make arguments: ignoring Storm logging and cfg, passing our source function</span>
                                   <span onmouseout="hideTip(event, 'fs3', 101)" onmouseover="showTip(event, 'fs3', 101)" class="f">ignore</span>                   <span class="c">// no deactivation</span>
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs3', 102)" onmouseover="showTip(event, 'fs3', 102)" class="f">withParallelism</span> <span class="n">4</span>
        
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 103)" onmouseover="showTip(event, 'fs3', 103)" class="i">splitBolt</span> <span class="o">=</span> 
            <span onmouseout="hideTip(event, 'fs3', 104)" onmouseover="showTip(event, 'fs3', 104)" class="f">splitIntoWords</span>
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs3', 105)" onmouseover="showTip(event, 'fs3', 105)" class="t">Bolt</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs21', 106)" onmouseover="showTip(event, 'fs21', 106)" class="f">run</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs3', 107)" onmouseover="showTip(event, 'fs3', 107)" class="f">log</span> <span onmouseout="hideTip(event, 'fs3', 108)" onmouseover="showTip(event, 'fs3', 108)" class="i">cfg</span> <span onmouseout="hideTip(event, 'fs3', 109)" onmouseover="showTip(event, 'fs3', 109)" class="i">tuple</span> <span onmouseout="hideTip(event, 'fs3', 110)" onmouseover="showTip(event, 'fs3', 110)" class="f">emit</span> <span class="k">-&gt;</span> (<span onmouseout="hideTip(event, 'fs3', 111)" onmouseover="showTip(event, 'fs3', 111)" class="i">tuple</span>, <span onmouseout="hideTip(event, 'fs3', 112)" onmouseover="showTip(event, 'fs3', 112)" class="f">emit</span>)) <span class="c">// make arguments: pass incoming tuple and emit function</span>
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs3', 113)" onmouseover="showTip(event, 'fs3', 113)" class="f">withParallelism</span> <span class="n">4</span>
        
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 114)" onmouseover="showTip(event, 'fs3', 114)" class="i">countBolt</span> <span class="o">=</span> 
            <span onmouseout="hideTip(event, 'fs3', 115)" onmouseover="showTip(event, 'fs3', 115)" class="f">countWords</span>
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs3', 116)" onmouseover="showTip(event, 'fs3', 116)" class="t">Bolt</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs21', 117)" onmouseover="showTip(event, 'fs21', 117)" class="f">run</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs3', 118)" onmouseover="showTip(event, 'fs3', 118)" class="f">log</span> <span onmouseout="hideTip(event, 'fs3', 119)" onmouseover="showTip(event, 'fs3', 119)" class="i">cfg</span> <span onmouseout="hideTip(event, 'fs3', 120)" onmouseover="showTip(event, 'fs3', 120)" class="i">tuple</span> <span onmouseout="hideTip(event, 'fs3', 121)" onmouseover="showTip(event, 'fs3', 121)" class="f">emit</span> <span class="k">-&gt;</span> (<span onmouseout="hideTip(event, 'fs3', 122)" onmouseover="showTip(event, 'fs3', 122)" class="i">tuple</span>, <span onmouseout="hideTip(event, 'fs3', 123)" onmouseover="showTip(event, 'fs3', 123)" class="f">increment</span>, <span onmouseout="hideTip(event, 'fs3', 124)" onmouseover="showTip(event, 'fs3', 124)" class="f">emit</span>))
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs3', 125)" onmouseover="showTip(event, 'fs3', 125)" class="f">withParallelism</span> <span class="n">4</span>
        
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 126)" onmouseover="showTip(event, 'fs3', 126)" class="i">logBolt</span> <span class="o">=</span> 
            <span onmouseout="hideTip(event, 'fs3', 127)" onmouseover="showTip(event, 'fs3', 127)" class="f">logResult</span>
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs3', 128)" onmouseover="showTip(event, 'fs3', 128)" class="t">Bolt</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs21', 129)" onmouseover="showTip(event, 'fs21', 129)" class="f">run</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs3', 130)" onmouseover="showTip(event, 'fs3', 130)" class="f">log</span> <span onmouseout="hideTip(event, 'fs3', 131)" onmouseover="showTip(event, 'fs3', 131)" class="i">cfg</span> <span class="k">-&gt;</span>                           <span class="c">// make arguments: pass PID-log and incoming tuple </span>
                            <span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 132)" onmouseover="showTip(event, 'fs3', 132)" class="f">mylog</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs3', 133)" onmouseover="showTip(event, 'fs3', 133)" class="i">Common</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 134)" onmouseover="showTip(event, 'fs3', 134)" class="i">Logging</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 135)" onmouseover="showTip(event, 'fs3', 135)" class="i">asyncLog</span> (<span onmouseout="hideTip(event, 'fs3', 136)" onmouseover="showTip(event, 'fs3', 136)" class="i">Diagnostics</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 137)" onmouseover="showTip(event, 'fs22', 137)" class="i">Process</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs23', 138)" onmouseover="showTip(event, 'fs23', 138)" class="i">GetCurrentProcess</span>()<span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 139)" onmouseover="showTip(event, 'fs3', 139)" class="i">Id</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 140)" onmouseover="showTip(event, 'fs3', 140)" class="i">ToString</span>()<span class="o">+</span><span class="s">&quot;_count&quot;</span>)
                            <span class="k">fun</span> <span onmouseout="hideTip(event, 'fs3', 141)" onmouseover="showTip(event, 'fs3', 141)" class="i">tuple</span> <span onmouseout="hideTip(event, 'fs3', 142)" onmouseover="showTip(event, 'fs3', 142)" class="f">emit</span> <span class="k">-&gt;</span> (<span onmouseout="hideTip(event, 'fs3', 143)" onmouseover="showTip(event, 'fs3', 143)" class="f">mylog</span>, <span onmouseout="hideTip(event, 'fs3', 144)" onmouseover="showTip(event, 'fs3', 144)" class="i">tuple</span>))
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs3', 145)" onmouseover="showTip(event, 'fs3', 145)" class="f">withParallelism</span> <span class="n">2</span>
        
        <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs3', 146)" onmouseover="showTip(event, 'fs3', 146)" class="i">sentencesSpout</span> <span class="o">--&gt;</span> <span onmouseout="hideTip(event, 'fs3', 147)" onmouseover="showTip(event, 'fs3', 147)" class="i">splitBolt</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs3', 148)" onmouseover="showTip(event, 'fs3', 148)" class="t">Shuffle</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs24', 149)" onmouseover="showTip(event, 'fs24', 149)" class="f">on</span> <span onmouseout="hideTip(event, 'fs3', 150)" onmouseover="showTip(event, 'fs3', 150)" class="p">Sentence</span>               <span class="c">// emit from sentencesSpout to splitBolt on Sentence stream, shuffle among target task instances</span>
        <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs3', 151)" onmouseover="showTip(event, 'fs3', 151)" class="i">splitBolt</span> <span class="o">--&gt;</span> <span onmouseout="hideTip(event, 'fs3', 152)" onmouseover="showTip(event, 'fs3', 152)" class="i">countBolt</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs3', 153)" onmouseover="showTip(event, 'fs3', 153)" class="t">Group</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs25', 154)" onmouseover="showTip(event, 'fs25', 154)" class="f">by</span> (<span class="k">function</span> <span onmouseout="hideTip(event, 'fs3', 155)" onmouseover="showTip(event, 'fs3', 155)" class="p">Word</span> <span onmouseout="hideTip(event, 'fs26', 156)" onmouseover="showTip(event, 'fs26', 156)" class="i">w</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs26', 157)" onmouseover="showTip(event, 'fs26', 157)" class="i">w</span>)        <span class="c">// emit from splitBolt into countBolt on Word stream, group by word (into the same task instance)</span>
        <span class="k">yield</span> <span onmouseout="hideTip(event, 'fs3', 158)" onmouseover="showTip(event, 'fs3', 158)" class="i">countBolt</span> <span class="o">--&gt;</span> <span onmouseout="hideTip(event, 'fs3', 159)" onmouseover="showTip(event, 'fs3', 159)" class="i">logBolt</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs3', 160)" onmouseover="showTip(event, 'fs3', 160)" class="t">Group</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs25', 161)" onmouseover="showTip(event, 'fs25', 161)" class="f">by</span> (<span class="k">function</span> <span onmouseout="hideTip(event, 'fs3', 162)" onmouseover="showTip(event, 'fs3', 162)" class="p">WordCount</span> (<span onmouseout="hideTip(event, 'fs26', 163)" onmouseover="showTip(event, 'fs26', 163)" class="i">w</span>,_) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs26', 164)" onmouseover="showTip(event, 'fs26', 164)" class="i">w</span>) <span class="c">// emit from countBolt into logBolt on WordCount stream, group by word value</span>
    }
</code></pre></td>
</tr>
</table>
<p>Here we define the graph by declaring the components and connecting them with arrows.
The lambda arguments for the "run" methods provide the opportunity to carry out construction of the arguments that will be passed into the component functions, where:</p>
<ul>
<li><code>log</code> is the Storm log factory</li>
<li><code>cfg</code> is the runtime configuration passed in from Storm</li>
<li><code>tuple</code> is the instance of the schema DU coming in</li>
<li><code>emit</code> is the function to emit another tuple</li>
</ul>
<p><code>log</code> and <code>cfg</code> are fixed once (curried) and as demonstrated in the <code>logBolt</code>'s <code>mkArgs</code> lambda, one time-initialization can be carried out by inserting arbitrary code before <code>tuple</code> and <code>emit</code> arguments.
This initialization will not be triggered unless the task execution is actually requested by Storm for this specific instance of the process.</p>
<h2><a name="Submitting-the-topology-for-execution" class="anchor" href="#Submitting-the-topology-for-execution">Submitting the topology for execution</a></h2>
<p>Storm accepts JARs for code distribution and FsShelter provides functions to package our assemblies and upload them to Nimbus.
Once the code is uploaded, Storm needs to be told how to run it and FsShelter has functions that convert the above representation into that of Nimbus API.
Storm then starts the supervising processes across the cluster and spins up a copy of our executable for each task instance in our topology.
FsShelter's <code>Task</code> will perform the handshake that will determine which component a given process instance has been assigned to execute:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs3', 165)" onmouseover="showTip(event, 'fs3', 165)" class="i">sampleTopology</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs3', 166)" onmouseover="showTip(event, 'fs3', 166)" class="t">Task</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs27', 167)" onmouseover="showTip(event, 'fs27', 167)" class="f">ofTopology</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs3', 168)" onmouseover="showTip(event, 'fs3', 168)" class="t">Task</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs28', 169)" onmouseover="showTip(event, 'fs28', 169)" class="f">run</span> <span onmouseout="hideTip(event, 'fs3', 170)" onmouseover="showTip(event, 'fs3', 170)" class="t">ProtoIO</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs29', 171)" onmouseover="showTip(event, 'fs29', 171)" class="f">start</span> <span class="c">// here we specify which serializer to use when talking to Storm</span>
</code></pre></td>
</tr>
</table>
<p>Then the execution will be handed over to one of the corresponding "dispatchers", which will handle the subsequent interaction between Storm and the component function.</p>
<p>Keep in mind that:</p>
<ul>
<li>STDIN/STDOUT are reserved for communications with Storm and any IO the component is going to do has to go through some other channel (no console logging!).</li>
<li>out of the box Storm only supports JSON multilang. For faster IO, consider <a href="https://github.com/prolucid/protoshell">ProtoShell</a>. The serilizer JAR can be bundled along with the submitted topology or deployed in Storm's classpath beforehand.</li>
</ul>
<h2><a name="Exporting-the-topology-graph" class="anchor" href="#Exporting-the-topology-graph">Exporting the topology graph</a></h2>
<p>FsShelter includes a completely customizable GraphViz (dot) export functionality. Here's what the word count topology looks like with default renderers:</p>
<p><img src="svg/WordCount.svg" alt="SVG" title="WordCount (SVG)" /></p>
<p>The dotted lines represent "unanchored" streams and the number inside the <code>[]</code> shows the parallelism hint.
This was achived by a simple export to console:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs3', 172)" onmouseover="showTip(event, 'fs3', 172)" class="i">sampleTopology</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs3', 173)" onmouseover="showTip(event, 'fs3', 173)" class="t">DotGraph</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs30', 174)" onmouseover="showTip(event, 'fs30', 174)" class="f">writeToConsole</span>
</code></pre></td>
</tr>
</table>
<p>Followed by further conversion into a desired format, piping the markup into GraphViz:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="bash">dotnet samples/WordCount/bin/Release/netcoreapp2.1/WordCount.dll graph | dot -Tsvg -o build/WordCount.svg
</code></pre></td></tr></table>
<p>It is also possible to generate graphs with colour-coded streams:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs3', 175)" onmouseover="showTip(event, 'fs3', 175)" class="i">sampleTopology</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs3', 176)" onmouseover="showTip(event, 'fs3', 176)" class="t">DotGraph</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs31', 177)" onmouseover="showTip(event, 'fs31', 177)" class="f">writeColourizedToConsole</span>
</code></pre></td>
</tr>
</table>
<p><img src="svg/WordCount_colourized.svg" alt="SVG" title="Colourized WordCount (SVG)" /></p>
<p>Alternatively, you can provide your own X11 colour scheme:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 178)" onmouseover="showTip(event, 'fs3', 178)" class="i">customColours</span> <span class="o">=</span> [| <span class="s">&quot;purple&quot;</span>; <span class="s">&quot;dodgerblue&quot;</span>; <span class="s">&quot;springgreen&quot;</span>; <span class="s">&quot;olivedrab&quot;</span>; <span class="s">&quot;orange&quot;</span>; <span class="s">&quot;orangered&quot;</span>; <span class="s">&quot;maroon&quot;</span>; <span class="s">&quot;black&quot;</span> |]
<span onmouseout="hideTip(event, 'fs3', 179)" onmouseover="showTip(event, 'fs3', 179)" class="i">sampleTopology</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs3', 180)" onmouseover="showTip(event, 'fs3', 180)" class="t">DotGraph</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 181)" onmouseover="showTip(event, 'fs3', 181)" class="f">exportToDot</span> (<span onmouseout="hideTip(event, 'fs3', 182)" onmouseover="showTip(event, 'fs3', 182)" class="i">DotGraph</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 183)" onmouseover="showTip(event, 'fs3', 183)" class="i">writeHeader</span>, <span onmouseout="hideTip(event, 'fs3', 184)" onmouseover="showTip(event, 'fs3', 184)" class="i">DotGraph</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 185)" onmouseover="showTip(event, 'fs3', 185)" class="i">writeFooter</span>, <span onmouseout="hideTip(event, 'fs3', 186)" onmouseover="showTip(event, 'fs3', 186)" class="i">DotGraph</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 187)" onmouseover="showTip(event, 'fs3', 187)" class="i">writeSpout</span>, <span onmouseout="hideTip(event, 'fs3', 188)" onmouseover="showTip(event, 'fs3', 188)" class="i">DotGraph</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 189)" onmouseover="showTip(event, 'fs3', 189)" class="i">writeBolt</span>, <span onmouseout="hideTip(event, 'fs3', 190)" onmouseover="showTip(event, 'fs3', 190)" class="i">DotGraph</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 191)" onmouseover="showTip(event, 'fs3', 191)" class="i">writeColourfulStream</span> <span class="o">&lt;|</span> <span onmouseout="hideTip(event, 'fs3', 192)" onmouseover="showTip(event, 'fs3', 192)" class="i">DotGraph</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs32', 193)" onmouseover="showTip(event, 'fs32', 193)" class="i">getColour</span> <span onmouseout="hideTip(event, 'fs3', 194)" onmouseover="showTip(event, 'fs3', 194)" class="i">customColours</span>) <span onmouseout="hideTip(event, 'fs3', 195)" onmouseover="showTip(event, 'fs3', 195)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs33', 196)" onmouseover="showTip(event, 'fs33', 196)" class="i">Console</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs34', 197)" onmouseover="showTip(event, 'fs34', 197)" class="i">Out</span>
</code></pre></td>
</tr>
</table>
<p><img src="svg/WordCount_custom_colourized.svg" alt="SVG" title="Custom Colourized WordCount (SVG)" /></p>

<div class="tip" id="fs1">namespace System</div>
<div class="tip" id="fs2">namespace FsShelter</div>
<div class="tip" id="fs3"></div>
<div class="tip" id="fs4">val s : string</div>
<div class="tip" id="fs5">String.Split([&lt;ParamArray&gt;] separator: char []) : string []<br />String.Split(separator: string [], options: StringSplitOptions) : string []<br />String.Split(separator: char [], options: StringSplitOptions) : string []<br />String.Split(separator: char [], count: int) : string []<br />String.Split(separator: string [], count: int, options: StringSplitOptions) : string []<br />String.Split(separator: char [], count: int, options: StringSplitOptions) : string []</div>
<div class="tip" id="fs6">field StringSplitOptions.RemoveEmptyEntries = 1</div>
<div class="tip" id="fs7">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;U&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.map</div>
<div class="tip" id="fs8">val iter : action:(&#39;T -&gt; unit) -&gt; source:seq&lt;&#39;T&gt; -&gt; unit<br /><br />Full name: Microsoft.FSharp.Collections.Seq.iter</div>
<div class="tip" id="fs9">Multiple items<br />type Random =<br />&#160;&#160;new : unit -&gt; Random + 1 overload<br />&#160;&#160;member Next : unit -&gt; int + 2 overloads<br />&#160;&#160;member NextBytes : buffer:byte[] -&gt; unit<br />&#160;&#160;member NextDouble : unit -&gt; float<br /><br />Full name: System.Random<br /><br />--------------------<br />Random() : unit<br />Random(Seed: int) : unit</div>
<div class="tip" id="fs10">Random.Next() : int<br />Random.Next(maxValue: int) : int<br />Random.Next(minValue: int, maxValue: int) : int</div>
<div class="tip" id="fs11">property List.Length: int</div>
<div class="tip" id="fs12">namespace System.Collections.Concurrent</div>
<div class="tip" id="fs13">Multiple items<br />type ConcurrentDictionary&lt;&#39;TKey,&#39;TValue&gt; =<br />&#160;&#160;new : unit -&gt; ConcurrentDictionary&lt;&#39;TKey, &#39;TValue&gt; + 6 overloads<br />&#160;&#160;member AddOrUpdate : key:&#39;TKey * addValueFactory:Func&lt;&#39;TKey, &#39;TValue&gt; * updateValueFactory:Func&lt;&#39;TKey, &#39;TValue, &#39;TValue&gt; -&gt; &#39;TValue + 2 overloads<br />&#160;&#160;member Clear : unit -&gt; unit<br />&#160;&#160;member ContainsKey : key:&#39;TKey -&gt; bool<br />&#160;&#160;member Count : int<br />&#160;&#160;member GetEnumerator : unit -&gt; IEnumerator&lt;KeyValuePair&lt;&#39;TKey, &#39;TValue&gt;&gt;<br />&#160;&#160;member GetOrAdd : key:&#39;TKey * valueFactory:Func&lt;&#39;TKey, &#39;TValue&gt; -&gt; &#39;TValue + 2 overloads<br />&#160;&#160;member IsEmpty : bool<br />&#160;&#160;member Item : &#39;TKey -&gt; &#39;TValue with get, set<br />&#160;&#160;member Keys : ICollection&lt;&#39;TKey&gt;<br />&#160;&#160;...<br /><br />Full name: System.Collections.Concurrent.ConcurrentDictionary&lt;_,_&gt;<br /><br />--------------------<br />Collections.Concurrent.ConcurrentDictionary() : unit<br />Collections.Concurrent.ConcurrentDictionary(collection: Collections.Generic.IEnumerable&lt;Collections.Generic.KeyValuePair&lt;&#39;TKey,&#39;TValue&gt;&gt;) : unit<br />Collections.Concurrent.ConcurrentDictionary(comparer: Collections.Generic.IEqualityComparer&lt;&#39;TKey&gt;) : unit<br />Collections.Concurrent.ConcurrentDictionary(concurrencyLevel: int, capacity: int) : unit<br />Collections.Concurrent.ConcurrentDictionary(collection: Collections.Generic.IEnumerable&lt;Collections.Generic.KeyValuePair&lt;&#39;TKey,&#39;TValue&gt;&gt;, comparer: Collections.Generic.IEqualityComparer&lt;&#39;TKey&gt;) : unit<br />Collections.Concurrent.ConcurrentDictionary(concurrencyLevel: int, collection: Collections.Generic.IEnumerable&lt;Collections.Generic.KeyValuePair&lt;&#39;TKey,&#39;TValue&gt;&gt;, comparer: Collections.Generic.IEqualityComparer&lt;&#39;TKey&gt;) : unit<br />Collections.Concurrent.ConcurrentDictionary(concurrencyLevel: int, capacity: int, comparer: Collections.Generic.IEqualityComparer&lt;&#39;TKey&gt;) : unit</div>
<div class="tip" id="fs14">val c : int64 ref</div>
<div class="tip" id="fs15">Collections.Concurrent.ConcurrentDictionary.GetOrAdd(key: string, value: int64 ref) : int64 ref<br />Collections.Concurrent.ConcurrentDictionary.GetOrAdd(key: string, valueFactory: Func&lt;string,int64 ref&gt;) : int64 ref<br />Collections.Concurrent.ConcurrentDictionary.GetOrAdd&lt;&#39;TArg&gt;(key: string, valueFactory: Func&lt;string,&#39;TArg,int64 ref&gt;, factoryArgument: &#39;TArg) : int64 ref</div>
<div class="tip" id="fs16">type Interlocked =<br />&#160;&#160;static member Add : location1:int * value:int -&gt; int + 1 overload<br />&#160;&#160;static member CompareExchange : location1:int * value:int * comparand:int -&gt; int + 6 overloads<br />&#160;&#160;static member Decrement : location:int -&gt; int + 1 overload<br />&#160;&#160;static member Exchange : location1:int * value:int -&gt; int + 6 overloads<br />&#160;&#160;static member Increment : location:int -&gt; int + 1 overload<br />&#160;&#160;static member MemoryBarrier : unit -&gt; unit<br />&#160;&#160;static member Read : location:int64 -&gt; int64<br /><br />Full name: System.Threading.Interlocked</div>
<div class="tip" id="fs17">Threading.Interlocked.Increment(location: byref&lt;int64&gt;) : int64<br />Threading.Interlocked.Increment(location: byref&lt;int&gt;) : int</div>
<div class="tip" id="fs18">Ref.contents: int64</div>
<div class="tip" id="fs19">module DSL<br /><br />from FsShelter</div>
<div class="tip" id="fs20">val runUnreliable : mkArgs:((Multilang.LogLevel -&gt; string -&gt; unit) -&gt; Conf -&gt; &#39;args) -&gt; deactivate:(&#39;args -&gt; unit) -&gt; next:Next&lt;&#39;args,&#39;t&gt; -&gt; Topology.Spout&lt;&#39;t&gt;<br /><br />Full name: FsShelter.DSL.Spout.runUnreliable</div>
<div class="tip" id="fs21">val run : mkArgs:((Multilang.LogLevel -&gt; string -&gt; unit) -&gt; Conf -&gt; &#39;t -&gt; (&#39;t -&gt; unit) -&gt; &#39;a) -&gt; consume:Consume&lt;&#39;a&gt; -&gt; Topology.Bolt&lt;&#39;t&gt;<br /><br />Full name: FsShelter.DSL.Bolt.run</div>
<div class="tip" id="fs22">Multiple items<br />type Process =<br />&#160;&#160;inherit Component<br />&#160;&#160;new : unit -&gt; Process<br />&#160;&#160;member BasePriority : int<br />&#160;&#160;member BeginErrorReadLine : unit -&gt; unit<br />&#160;&#160;member BeginOutputReadLine : unit -&gt; unit<br />&#160;&#160;member CancelErrorRead : unit -&gt; unit<br />&#160;&#160;member CancelOutputRead : unit -&gt; unit<br />&#160;&#160;member Close : unit -&gt; unit<br />&#160;&#160;member CloseMainWindow : unit -&gt; bool<br />&#160;&#160;member EnableRaisingEvents : bool with get, set<br />&#160;&#160;member ExitCode : int<br />&#160;&#160;...<br /><br />Full name: System.Diagnostics.Process<br /><br />--------------------<br />Diagnostics.Process() : unit</div>
<div class="tip" id="fs23">Diagnostics.Process.GetCurrentProcess() : Diagnostics.Process</div>
<div class="tip" id="fs24">static member Shuffle.on : case:Quotations.Expr&lt;(&#39;a0 -&gt; &#39;t)&gt; -&gt; (bool -&gt; Topology.ComponentId -&gt; Topology.ComponentId -&gt; Topology.Stream&lt;&#39;t&gt;)</div>
<div class="tip" id="fs25">static member Group.by : select:Quotations.Expr&lt;(&#39;t -&gt; &#39;p)&gt; -&gt; (bool -&gt; Topology.ComponentId -&gt; Topology.ComponentId -&gt; Topology.Stream&lt;&#39;t&gt;)</div>
<div class="tip" id="fs26">val w : string</div>
<div class="tip" id="fs27">val ofTopology : t:Topology.Topology&lt;&#39;t&gt; -&gt; compId:Topology.ComponentId -&gt; Topology.Runnable&lt;&#39;t&gt;<br /><br />Full name: FsShelter.Task.ofTopology</div>
<div class="tip" id="fs28">val run : mkIO:(Task.Log -&gt; Topology.IO&lt;&#39;t&gt;) -&gt; task:Task.Task&lt;&#39;t&gt; -&gt; unit<br /><br />Full name: FsShelter.Task.run</div>
<div class="tip" id="fs29">val start : log:Task.Log -&gt; Topology.IO&lt;&#39;a&gt;<br /><br />Full name: FsShelter.ProtoIO.start</div>
<div class="tip" id="fs30">val writeToConsole : t:Topology.Topology&lt;&#39;a&gt; -&gt; unit<br /><br />Full name: FsShelter.DotGraph.writeToConsole</div>
<div class="tip" id="fs31">val writeColourizedToConsole : t:Topology.Topology&lt;&#39;a&gt; -&gt; unit<br /><br />Full name: FsShelter.DotGraph.writeColourizedToConsole</div>
<div class="tip" id="fs32">val getColour : colours:string [] -&gt; (string -&gt; string)<br /><br />Full name: FsShelter.DotGraph.getColour</div>
<div class="tip" id="fs33">type Console =<br />&#160;&#160;static member BackgroundColor : ConsoleColor with get, set<br />&#160;&#160;static member Beep : unit -&gt; unit + 1 overload<br />&#160;&#160;static member BufferHeight : int with get, set<br />&#160;&#160;static member BufferWidth : int with get, set<br />&#160;&#160;static member CapsLock : bool<br />&#160;&#160;static member Clear : unit -&gt; unit<br />&#160;&#160;static member CursorLeft : int with get, set<br />&#160;&#160;static member CursorSize : int with get, set<br />&#160;&#160;static member CursorTop : int with get, set<br />&#160;&#160;static member CursorVisible : bool with get, set<br />&#160;&#160;...<br /><br />Full name: System.Console</div>
<div class="tip" id="fs34">property Console.Out: IO.TextWriter</div>

        </div>
        <div class="span3">
          <img src="https://prolucid.github.io/FsShelter/img/logo.png" alt="F# Project" style="width:150px;margin:10px" />  
          <ul class="nav nav-list" id="menu" style="margin-top: 20px;">
            <li class="nav-header">FsShelter</li>
            <li><a href="https://prolucid.github.io/FsShelter/index.html">Home page</a></li>
            <li class="divider"></li>
            <li><a href="http://nuget.org/packages/FsShelter">Get Library via NuGet</a></li>
            <li><a href="http://github.com/Prolucid/FsShelter">Source Code on GitHub</a></li>
            <li><a href="https://prolucid.github.io/FsShelter/LICENSE.html">License</a></li>
            <li><a href="https://prolucid.github.io/FsShelter/RELEASE_NOTES.html">Release Notes</a></li>
            
            <li class="nav-header">Getting started
            <li><a href="https://prolucid.github.io/FsShelter/wordcount.html">WordCount topology</a>
			<ul>
			<li><a href="https://prolucid.github.io/FsShelter/wordcount.html#Defining-the-schema">Schema</a></li>
            <li><a href="https://prolucid.github.io/FsShelter/wordcount.html#Defining-unreliable-spouts">Spout</a></li>
			<li><a href="https://prolucid.github.io/FsShelter/wordcount.html#Defining-bolts">Bolt</a></li>
			<li><a href="https://prolucid.github.io/FsShelter/wordcount.html#Using-F-DSL-to-define-a-topology">Topology</a></li>
			<li><a href="https://prolucid.github.io/FsShelter/wordcount.html#Submitting-the-topology-for-execution">Submitting for execution</a></li>
            <li><a href="https://prolucid.github.io/FsShelter/wordcount.html#Exporting-the-topology-graph">Topology graph</a></li>
			</ul>
			</li>
      <li>
          <a href="https://prolucid.github.io/FsShelter/guaranteed.html">Guaranteed processing</a>
          <ul>
              <li><a href="https://prolucid.github.io/FsShelter/guaranteed.html#Defining-reliable-spouts">Reliable Spout</a></li>
              <li><a href="https://prolucid.github.io/FsShelter/guaranteed.html#Anchoring">Anchoring</a></li>
          </ul>
      <li>
          <a href="https://prolucid.github.io/FsShelter/self-hosting.html">Self-hosting</a>
			</li>
      <li><a href="https://prolucid.github.io/FsShelter/schema.html">Schema considerations</a></li>

            <li class="nav-header">Documentation</li>
            <li><a href="https://prolucid.github.io/FsShelter/reference/index.html">API Reference</a></li>
          </ul>
        </div>
      </div>
    </div>
    <a href="http://github.com/Prolucid/FsShelter"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"/></a>
  </body>
  </html>
