<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>index</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="F# DSL and runtime for Storm topologies"/>
    <meta name="author" content="Eugene Tolmachev"/>

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"/>

    <link type="text/css" rel="stylesheet" href="/FsShelter/content/style.css" />
    <link rel="icon"
            type="image/png"
            href="/FsShelter/img/logo.png" />
    <script type="text/javascript" src="/FsShelter/content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="https://prolucid.github.io">prolucid</a></li>
          <li><a href="http://fsharp.org">fsharp.org</a></li>
          <li><a href="http://github.com/Prolucid/FsShelter">github page</a></li>
        </ul>
        <h3 class="muted"><a href="/FsShelter/index.html">FsShelter</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<h2><a name="Overview" class="anchor" href="#Overview">Overview</a></h2>
<p>FsShelter is a library for implementation of <a href="https://storm.apache.org/">Apache Storm</a> components and topologies in F#.
FsShelter is based on and a major rewrite of <a href="https://github.com/FsStorm">FsStorm</a>. It departs from FsStorm in significant ways and therefore has been split into its own project.</p>
<p>Overall, the library provides "batteries included" experience with wrappers for Nimbus API as well as support for packaging and exporting:</p>
<ul>
<li>bundle and submit a topology for execution w/o needing JDK or Storm CLI</li>
<li>include Storm-side serializer along</li>
<li>kill a running topology</li>
<li>generate a topology graph as part of your build</li>
</ul>
<p>The topology and the components could be implemented in a single EXE project and are executed by Storm via its <a href="https://storm.apache.org/documentation/Multilang-protocol.html">multilang</a> protocol as separate processes - one for each task/instance.
Corresponding <a href="https://github.com/prolucid/protoshell">ProtoShell</a> Storm-side library facilitates Protobuf serialization, which improves throughput of FsShelter topologies as compared to default JSON.
See samples to learn how to bundle the assemblies and a serializer for upload to Storm.</p>
<p>Bring your own, if you need it:</p>
<ul>
<li>command line parser</li>
<li>logging</li>
<li>custom serializer</li>
</ul>
<h2><a name="FsShelter-topology-schema" class="anchor" href="#FsShelter-topology-schema">FsShelter topology schema</a></h2>
<p>While Storm tuples are dynamically typed and to a large extend the types are transparent to Storm itself, they are not types-less.
Mistakes and inconsistencies between declared outputs and tuple consumers could easily lead to errors detectable at run-time only and may be frustrating to test, detect and fix.
FsShelter introduces concept of topology schema, defined as F# discriminated union:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="t">BasicSchema</span> <span class="o">=</span> 
    | <span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="p">Original</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="t">int</span>
    | <span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="p">Incremented</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs4', 6)" onmouseover="showTip(event, 'fs4', 6)" class="t">int</span>
</code></pre></td>
</tr>
</table>
<p>where every DU case becomes a distinct stream in the topology. The fields of each DU case will become tuple fields in Storm streams.</p>
<p>It is often handy to define a type that's shared across streams and FsShelter supports defining cases with records:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs6', 7)" onmouseover="showTip(event, 'fs6', 7)" class="t">Number</span> <span class="o">=</span> { <span onmouseout="hideTip(event, 'fs7', 8)" onmouseover="showTip(event, 'fs7', 8)" class="i">X</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs4', 9)" onmouseover="showTip(event, 'fs4', 9)" class="t">int</span>; <span onmouseout="hideTip(event, 'fs8', 10)" onmouseover="showTip(event, 'fs8', 10)" class="i">Desc</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs9', 11)" onmouseover="showTip(event, 'fs9', 11)" class="t">string</span> }

<span class="k">type</span> <span onmouseout="hideTip(event, 'fs10', 12)" onmouseover="showTip(event, 'fs10', 12)" class="t">RecordSchema</span> <span class="o">=</span> 
    | <span onmouseout="hideTip(event, 'fs11', 13)" onmouseover="showTip(event, 'fs11', 13)" class="p">Original</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs4', 14)" onmouseover="showTip(event, 'fs4', 14)" class="t">int</span>
    | <span onmouseout="hideTip(event, 'fs12', 15)" onmouseover="showTip(event, 'fs12', 15)" class="p">Described</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs6', 16)" onmouseover="showTip(event, 'fs6', 16)" class="t">Number</span>
    | <span onmouseout="hideTip(event, 'fs13', 17)" onmouseover="showTip(event, 'fs13', 17)" class="p">Translated</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs6', 18)" onmouseover="showTip(event, 'fs6', 18)" class="t">Number</span>
</code></pre></td>
</tr>
</table>
<p>It is also common to join/zip tuples from multiple streams and FsShelter supports defining cases with records adjoined:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs14', 19)" onmouseover="showTip(event, 'fs14', 19)" class="t">RecordsSchema</span> <span class="o">=</span> 
    | <span onmouseout="hideTip(event, 'fs15', 20)" onmouseover="showTip(event, 'fs15', 20)" class="p">Original</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs6', 21)" onmouseover="showTip(event, 'fs6', 21)" class="t">Number</span>
    | <span onmouseout="hideTip(event, 'fs16', 22)" onmouseover="showTip(event, 'fs16', 22)" class="p">Doubled</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs6', 23)" onmouseover="showTip(event, 'fs6', 23)" class="t">Number</span><span class="o">*</span><span onmouseout="hideTip(event, 'fs6', 24)" onmouseover="showTip(event, 'fs6', 24)" class="t">Number</span>
</code></pre></td>
</tr>
</table>
<p>Other than safety of working with statically-verified schema the reason we care about structure of the tuple is because we reference them in Storm grouping definitions.
FsShelter "flattens" the first immediate "layer" of the DU case so that all the fields, weither they come from the embedded record or the DU case itself, are available for grouping expressions.</p>
<p>Generic or nested schemas are also supported. For example:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs2', 25)" onmouseover="showTip(event, 'fs2', 25)" class="i">BasicSchema</span> <span class="o">=</span> 
    | <span onmouseout="hideTip(event, 'fs11', 26)" onmouseover="showTip(event, 'fs11', 26)" class="i">Original</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs4', 27)" onmouseover="showTip(event, 'fs4', 27)" class="i">int</span>
    | <span onmouseout="hideTip(event, 'fs5', 28)" onmouseover="showTip(event, 'fs5', 28)" class="i">Incremented</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs4', 29)" onmouseover="showTip(event, 'fs4', 29)" class="i">int</span>

<span class="k">type</span> <span onmouseout="hideTip(event, 'fs17', 30)" onmouseover="showTip(event, 'fs17', 30)" class="t">NestedSchema</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">a</span><span class="o">&gt;</span> <span class="o">=</span> 
    | <span onmouseout="hideTip(event, 'fs18', 31)" onmouseover="showTip(event, 'fs18', 31)" class="p">Named</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs9', 32)" onmouseover="showTip(event, 'fs9', 32)" class="t">string</span>
    | <span onmouseout="hideTip(event, 'fs19', 33)" onmouseover="showTip(event, 'fs19', 33)" class="p">Nested</span> <span class="k">of</span> <span class="o">&#39;</span><span class="i">a</span>
    
</code></pre></td>
</tr>
</table>
<p>where a topology can be defined with the signature: <code>Topology&lt;NestedSchema&lt;BasicSchema&gt;&gt;</code>.
This can be useful for implementing a base topology and extending it using a nested set of streams. Nested streams can be grouped on by adding the NestedStreamAttribute to the Nested case. Without this attribute, nested streams will be treated as blobs.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">type</span> <span onmouseout="hideTip(event, 'fs17', 34)" onmouseover="showTip(event, 'fs17', 34)" class="i">NestedSchema</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">a</span><span class="o">&gt;</span> <span class="o">=</span> 
    | <span class="i">Named</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs9', 35)" onmouseover="showTip(event, 'fs9', 35)" class="i">string</span>
    | [&lt;<span class="i">NestedStream</span>&gt;] <span onmouseout="hideTip(event, 'fs19', 36)" onmouseover="showTip(event, 'fs19', 36)" class="i">Nested</span> <span class="k">of</span> <span class="o">&#39;</span><span class="i">a</span>
</code></pre></td>
</tr>
</table>
<h2><a name="FsShelter-components" class="anchor" href="#FsShelter-components">FsShelter components</a></h2>
<p>Some of the flexibility of Storm has been hidden to provide simple developer experience for authoring event-driven solutions.
For exmple, FsShelter components are implemeted as simple functions:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// numbers spout - produces messages</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs20', 37)" onmouseover="showTip(event, 'fs20', 37)" class="f">numbers</span> <span onmouseout="hideTip(event, 'fs21', 38)" onmouseover="showTip(event, 'fs21', 38)" class="f">source</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs22', 39)" onmouseover="showTip(event, 'fs22', 39)" class="i">async</span> { <span class="k">return</span> <span onmouseout="hideTip(event, 'fs23', 40)" onmouseover="showTip(event, 'fs23', 40)" class="p">Some</span>(<span onmouseout="hideTip(event, 'fs15', 41)" onmouseover="showTip(event, 'fs15', 41)" class="p">Original</span>(<span onmouseout="hideTip(event, 'fs21', 42)" onmouseover="showTip(event, 'fs21', 42)" class="f">source</span>())) }
</code></pre></td>
</tr>
</table>
<p>The async body of a spout is expected to return an option if there's a tuple to emit or None if there's nothing to emit at this time.</p>
<p>Bolts can get a tuple on any number of streams, and so we pattern match:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// add 1 bolt - consumes and emits messages to Incremented stream</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs24', 43)" onmouseover="showTip(event, 'fs24', 43)" class="f">addOne</span> (<span onmouseout="hideTip(event, 'fs25', 44)" onmouseover="showTip(event, 'fs25', 44)" class="i">input</span>, <span onmouseout="hideTip(event, 'fs26', 45)" onmouseover="showTip(event, 'fs26', 45)" class="f">emit</span>) <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs22', 46)" onmouseover="showTip(event, 'fs22', 46)" class="i">async</span> { 
        <span class="k">match</span> <span onmouseout="hideTip(event, 'fs25', 47)" onmouseover="showTip(event, 'fs25', 47)" class="i">input</span> <span class="k">with</span>
        | <span onmouseout="hideTip(event, 'fs2', 48)" onmouseover="showTip(event, 'fs2', 48)" class="t">BasicSchema</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 49)" onmouseover="showTip(event, 'fs3', 49)" class="p">Original</span>(<span onmouseout="hideTip(event, 'fs27', 50)" onmouseover="showTip(event, 'fs27', 50)" class="i">x</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs5', 51)" onmouseover="showTip(event, 'fs5', 51)" class="p">Incremented</span>(<span onmouseout="hideTip(event, 'fs27', 52)" onmouseover="showTip(event, 'fs27', 52)" class="i">x</span> <span class="o">+</span> <span class="n">1</span>)
        | _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs28', 53)" onmouseover="showTip(event, 'fs28', 53)" class="f">failwithf</span> <span class="s">&quot;unexpected input: </span><span class="pf">%A</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs25', 54)" onmouseover="showTip(event, 'fs25', 54)" class="i">input</span>
        <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs26', 55)" onmouseover="showTip(event, 'fs26', 55)" class="f">emit</span>
    }
</code></pre></td>
</tr>
</table>
<p>The bolt can also emit at any time, and we can hold on to the passed emit function (with caveates).
Also, there can be as many arguments for the component functions as needed, the specifics will be determined when the components are put together in a topology.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// terminating bolt - consumes messages</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs29', 56)" onmouseover="showTip(event, 'fs29', 56)" class="f">logResult</span> (<span onmouseout="hideTip(event, 'fs30', 57)" onmouseover="showTip(event, 'fs30', 57)" class="f">info</span>, <span onmouseout="hideTip(event, 'fs25', 58)" onmouseover="showTip(event, 'fs25', 58)" class="i">input</span>) <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs22', 59)" onmouseover="showTip(event, 'fs22', 59)" class="i">async</span> { 
        <span class="k">match</span> <span onmouseout="hideTip(event, 'fs25', 60)" onmouseover="showTip(event, 'fs25', 60)" class="i">input</span> <span class="k">with</span>
        | <span onmouseout="hideTip(event, 'fs2', 61)" onmouseover="showTip(event, 'fs2', 61)" class="t">BasicSchema</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs5', 62)" onmouseover="showTip(event, 'fs5', 62)" class="p">Incremented</span>(<span onmouseout="hideTip(event, 'fs27', 63)" onmouseover="showTip(event, 'fs27', 63)" class="i">x</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs30', 64)" onmouseover="showTip(event, 'fs30', 64)" class="f">info</span> (<span onmouseout="hideTip(event, 'fs31', 65)" onmouseover="showTip(event, 'fs31', 65)" class="f">sprintf</span> <span class="s">&quot;</span><span class="pf">%A</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs27', 66)" onmouseover="showTip(event, 'fs27', 66)" class="i">x</span>)
        | _ <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs28', 67)" onmouseover="showTip(event, 'fs28', 67)" class="f">failwithf</span> <span class="s">&quot;unexpected input: </span><span class="pf">%A</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs25', 68)" onmouseover="showTip(event, 'fs25', 68)" class="i">input</span>
    }
</code></pre></td>
</tr>
</table>
<h2><a name="Using-F-DSL-to-define-the-topology" class="anchor" href="#Using-F-DSL-to-define-the-topology">Using F# DSL to define the topology</a></h2>
<p>Storm topology is a graph of spouts and bolts connected via streams. FsShelter provides an embedded DSL for defining the topologies, which allows for mix and match of native Java, external shell and FsShell components:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// define our source dependency</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs32', 69)" onmouseover="showTip(event, 'fs32', 69)" class="f">source</span> <span class="o">=</span> 
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs33', 70)" onmouseover="showTip(event, 'fs33', 70)" class="i">rnd</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs34', 71)" onmouseover="showTip(event, 'fs34', 71)" class="t">Random</span>()
    <span class="k">fun</span> () <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs33', 72)" onmouseover="showTip(event, 'fs33', 72)" class="i">rnd</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs35', 73)" onmouseover="showTip(event, 'fs35', 73)" class="f">Next</span>(<span class="n">0</span>, <span class="n">100</span>)

<span class="k">open</span> <span class="i">FsShelter</span><span class="o">.</span><span class="i">DSL</span>
<span class="k">open</span> <span class="i">FsShelter</span><span class="o">.</span><span class="i">Multilang</span>

<span class="c">//define the Storm topology</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs36', 74)" onmouseover="showTip(event, 'fs36', 74)" class="i">sampleTopology</span> <span class="o">=</span> 
    <span class="i">topology</span> <span class="s">&quot;Sample&quot;</span> { 
        <span class="k">let</span> <span class="i">s1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs20', 75)" onmouseover="showTip(event, 'fs20', 75)" class="i">numbers</span> <span class="o">|&gt;</span> <span class="i">runUnreliably</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs37', 76)" onmouseover="showTip(event, 'fs37', 76)" class="i">log</span> <span class="i">cfg</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs32', 77)" onmouseover="showTip(event, 'fs32', 77)" class="i">source</span>) <span class="c">// ignoring available Storm logging and cfg and passing our source function</span>
        
        <span class="k">let</span> <span class="i">b1</span> <span class="o">=</span> 
            <span onmouseout="hideTip(event, 'fs24', 78)" onmouseover="showTip(event, 'fs24', 78)" class="i">addOne</span>
            <span class="o">|&gt;</span> <span class="i">runBolt</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs37', 79)" onmouseover="showTip(event, 'fs37', 79)" class="i">log</span> <span class="i">cfg</span> <span class="i">tuple</span> <span class="i">emit</span> <span class="k">-&gt;</span> (<span class="i">tuple</span>, <span class="i">emit</span>)) <span class="c">// pass incoming tuple and emit function</span>
            <span class="o">|&gt;</span> <span class="i">withParallelism</span> <span class="n">2</span> <span class="c">// override default parallelism of 1</span>
        
        <span class="k">let</span> <span class="i">b2</span> <span class="o">=</span> 
            <span onmouseout="hideTip(event, 'fs29', 80)" onmouseover="showTip(event, 'fs29', 80)" class="i">logResult</span>
            <span class="o">|&gt;</span> <span class="i">runBolt</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs37', 81)" onmouseover="showTip(event, 'fs37', 81)" class="i">log</span> <span class="i">cfg</span> <span class="i">tuple</span> <span class="i">emit</span> <span class="k">-&gt;</span> ((<span onmouseout="hideTip(event, 'fs37', 82)" onmouseover="showTip(event, 'fs37', 82)" class="i">log</span> <span class="i">LogLevel</span><span class="o">.</span><span class="i">Info</span>), <span class="i">tuple</span>)) <span class="c">// example of passing Info-level Storm logger into the bolt</span>
            <span class="o">|&gt;</span> <span class="i">withParallelism</span> <span class="n">2</span>
        
        <span class="k">yield</span> <span class="i">s1</span> <span class="o">--&gt;</span> <span class="i">b1</span> <span class="o">|&gt;</span> <span class="i">shuffle</span><span class="o">.</span><span class="i">on</span> <span onmouseout="hideTip(event, 'fs2', 83)" onmouseover="showTip(event, 'fs2', 83)" class="i">BasicSchema</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 84)" onmouseover="showTip(event, 'fs3', 84)" class="i">Original</span> <span class="c">// emit from s1 to b1 on Original stream</span>
        <span class="k">yield</span> <span class="i">b1</span> <span class="o">--&gt;</span> <span class="i">b2</span> <span class="o">|&gt;</span> <span class="i">shuffle</span><span class="o">.</span><span class="i">on</span> <span onmouseout="hideTip(event, 'fs5', 85)" onmouseover="showTip(event, 'fs5', 85)" class="i">Incremented</span> <span class="c">// emit from b1 to b2 on Incremented stream</span>
    }
</code></pre></td>
</tr>
</table>
<p>Storm will start (a copy of) the same EXE for every component instance in the topology and will assign each instance a task it supposed to execute.</p>
<p>The topology can be packaged with all its dependecies and submitted using embedded Nimbus client, see the examples for details.</p>
<h2><a name="Exporting-the-topology-graph-in-DOT-format-GraphViz-using-F-scripts" class="anchor" href="#Exporting-the-topology-graph-in-DOT-format-GraphViz-using-F-scripts">Exporting the topology graph in DOT format (GraphViz) using F# scripts</a></h2>
<p>Once the number of components grows beyond trivial it is often handy to be able to visualize them and FsShelter includes a simple way to export the topology into a graph:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs36', 86)" onmouseover="showTip(event, 'fs36', 86)" class="i">sampleTopology</span> <span class="o">|&gt;</span> <span class="i">DotGraph</span><span class="o">.</span><span class="i">writeToConsole</span>
</code></pre></td>
</tr>
</table>
<p>See the samples included for further details.</p>
<h2><a name="Samples-amp-documentation" class="anchor" href="#Samples-amp-documentation">Samples &amp; documentation</a></h2>
<ul>
<li><p><a href="wordcount.html">WordCount</a> contains a "unreliable" spout example - emitted tuples do not require ack, could be lost in case of failure.</p></li>
<li><p><a href="guaranteed.html">Guaranteed</a> contains a "reliable" spout example - emitted tuples have unique ID and require ack.</p></li>
<li>
<p><a href="reference/index.html">API Reference</a> contains automatically generated documentation for public types, modules
and functions in the library.</p>
</li>
</ul>
<h2><a name="Getting-FsShelter" class="anchor" href="#Getting-FsShelter">Getting FsShelter</a></h2>
<div class="row">
  <div class="span1"></div>
  <div class="span6">
    <div class="well well-small" id="nuget">
      The FsShelter library can be installed from <a href="https://nuget.org/packages/FsShelter">NuGet</a> or <a href="https://www.myget.org/F/FsShelter/">MyGet</a>:
      <pre>PM> Install-Package FsShelter</pre>
    </div>
  </div>
  <div class="span1"></div>
</div>
<div class="row">
  <div class="span1"></div>
  <div class="span6">
    <div class="well well-small">
      The library can also be tried out quickly as a Docker container, downloaded from <a href="https://hub.docker.com/r/prolucid/fsshelter-samples/">docker hub</a>:
      <pre>$ docker run --name fsshelter-samples -d -p 8080:8080 prolucid/fsshelter-samples</pre>
    </div>
  </div>
  <div class="span1"></div>
</div>
<h2><a name="Contributing-and-copyright" class="anchor" href="#Contributing-and-copyright">Contributing and copyright</a></h2>
<p>The project is hosted on <a href="https://github.com/Prolucid/FsShelter">GitHub</a> where you can <a href="https://github.com/Prolucid/FsShelter/issues">report issues</a>, fork
the project and submit pull requests. If you're adding a new public API, please also
consider adding <a href="https://github.com/Prolucid/FsShelter/tree/master/docs/content">samples</a> that can be turned into a documentation. You might
also want to read the <a href="https://github.com/Prolucid/FsShelter/blob/master/README.md">library design notes</a> to understand how it works.</p>
<p>The library is available under Apache 2.0 license, which allows modification and
redistribution for both commercial and non-commercial purposes. For more information see the
<a href="https://github.com/Prolucid/FsShelter/blob/master/LICENSE.md">License file</a> in the GitHub repository.</p>
<h2><a name="Commercial-support" class="anchor" href="#Commercial-support">Commercial support</a></h2>
<p>Commercial training and support are available from the project sponsor:
<a href="http://prolucid.ca/" target="_blank"><img src="http://prolucid.ca/wp-content/uploads/2014/06/Logo-.jpg" alt="Prolucid" style="height:30px" border="0" /></a></p>

<div class="tip" id="fs1">namespace System</div>
<div class="tip" id="fs2">type BasicSchema =<br />&#160;&#160;| Original of int<br />&#160;&#160;| Incremented of int<br /><br />Full name: Index.BasicSchema</div>
<div class="tip" id="fs3">union case BasicSchema.Original: int -&gt; BasicSchema</div>
<div class="tip" id="fs4">Multiple items<br />val int : value:&#39;T -&gt; int (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.int<br /><br />--------------------<br />type int = int32<br /><br />Full name: Microsoft.FSharp.Core.int<br /><br />--------------------<br />type int&lt;&#39;Measure&gt; = int<br /><br />Full name: Microsoft.FSharp.Core.int&lt;_&gt;</div>
<div class="tip" id="fs5">union case BasicSchema.Incremented: int -&gt; BasicSchema</div>
<div class="tip" id="fs6">type Number =<br />&#160;&#160;{X: int;<br />&#160;&#160;&#160;Desc: string;}<br /><br />Full name: Index.Number</div>
<div class="tip" id="fs7">Number.X: int</div>
<div class="tip" id="fs8">Number.Desc: string</div>
<div class="tip" id="fs9">Multiple items<br />val string : value:&#39;T -&gt; string<br /><br />Full name: Microsoft.FSharp.Core.Operators.string<br /><br />--------------------<br />type string = String<br /><br />Full name: Microsoft.FSharp.Core.string</div>
<div class="tip" id="fs10">type RecordSchema =<br />&#160;&#160;| Original of int<br />&#160;&#160;| Described of Number<br />&#160;&#160;| Translated of Number<br /><br />Full name: Index.RecordSchema</div>
<div class="tip" id="fs11">union case RecordSchema.Original: int -&gt; RecordSchema</div>
<div class="tip" id="fs12">union case RecordSchema.Described: Number -&gt; RecordSchema</div>
<div class="tip" id="fs13">union case RecordSchema.Translated: Number -&gt; RecordSchema</div>
<div class="tip" id="fs14">type RecordsSchema =<br />&#160;&#160;| Original of Number<br />&#160;&#160;| Doubled of Number * Number<br /><br />Full name: Index.RecordsSchema</div>
<div class="tip" id="fs15">union case RecordsSchema.Original: Number -&gt; RecordsSchema</div>
<div class="tip" id="fs16">union case RecordsSchema.Doubled: Number * Number -&gt; RecordsSchema</div>
<div class="tip" id="fs17">type NestedSchema&lt;&#39;a&gt; =<br />&#160;&#160;| Named of string<br />&#160;&#160;| Nested of &#39;a<br /><br />Full name: Index.NestedSchema&lt;_&gt;</div>
<div class="tip" id="fs18">union case NestedSchema.Named: string -&gt; NestedSchema&lt;&#39;a&gt;</div>
<div class="tip" id="fs19">union case NestedSchema.Nested: &#39;a -&gt; NestedSchema&lt;&#39;a&gt;</div>
<div class="tip" id="fs20">val numbers : source:(unit -&gt; Number) -&gt; Async&lt;RecordsSchema option&gt;<br /><br />Full name: Index.numbers</div>
<div class="tip" id="fs21">val source : (unit -&gt; Number)</div>
<div class="tip" id="fs22">val async : AsyncBuilder<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.async</div>
<div class="tip" id="fs23">union case Option.Some: Value: &#39;T -&gt; Option&lt;&#39;T&gt;</div>
<div class="tip" id="fs24">val addOne : input:BasicSchema * emit:(BasicSchema -&gt; unit) -&gt; Async&lt;unit&gt;<br /><br />Full name: Index.addOne</div>
<div class="tip" id="fs25">val input : BasicSchema</div>
<div class="tip" id="fs26">val emit : (BasicSchema -&gt; unit)</div>
<div class="tip" id="fs27">val x : int</div>
<div class="tip" id="fs28">val failwithf : format:Printf.StringFormat&lt;&#39;T,&#39;Result&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.failwithf</div>
<div class="tip" id="fs29">val logResult : info:(string -&gt; unit) * input:BasicSchema -&gt; Async&lt;unit&gt;<br /><br />Full name: Index.logResult</div>
<div class="tip" id="fs30">val info : (string -&gt; unit)</div>
<div class="tip" id="fs31">val sprintf : format:Printf.StringFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.sprintf</div>
<div class="tip" id="fs32">val source : (unit -&gt; int)<br /><br />Full name: Index.source</div>
<div class="tip" id="fs33">val rnd : Random</div>
<div class="tip" id="fs34">Multiple items<br />type Random =<br />&#160;&#160;new : unit -&gt; Random + 1 overload<br />&#160;&#160;member Next : unit -&gt; int + 2 overloads<br />&#160;&#160;member NextBytes : buffer:byte[] -&gt; unit<br />&#160;&#160;member NextDouble : unit -&gt; float<br /><br />Full name: System.Random<br /><br />--------------------<br />Random() : unit<br />Random(Seed: int) : unit</div>
<div class="tip" id="fs35">Random.Next() : int<br />Random.Next(maxValue: int) : int<br />Random.Next(minValue: int, maxValue: int) : int</div>
<div class="tip" id="fs36">val sampleTopology : obj<br /><br />Full name: Index.sampleTopology</div>
<div class="tip" id="fs37">val log : value:&#39;T -&gt; &#39;T (requires member Log)<br /><br />Full name: Microsoft.FSharp.Core.Operators.log</div>

        </div>
        <div class="span3">
          <img src="/FsShelter/img/logo.png" alt="F# Project" style="width:150px;margin:10px" />  
          <ul class="nav nav-list" id="menu" style="margin-top: 20px;">
            <li class="nav-header">FsShelter</li>
            <li><a href="/FsShelter/index.html">Home page</a></li>
            <li class="divider"></li>
            <li><a href="http://nuget.org/packages/FsShelter">Get Library via NuGet</a></li>
            <li><a href="http://github.com/Prolucid/FsShelter">Source Code on GitHub</a></li>
            <li><a href="/FsShelter/LICENSE.html">License</a></li>
            <li><a href="/FsShelter/RELEASE_NOTES.html">Release Notes</a></li>
            
            <li class="nav-header">Getting started
            <li><a href="/FsShelter/wordcount.html">WordCount topology</a>
			<ul>
			<li><a href="/FsShelter/wordcount.html#Defining-the-schema">Schema</a></li>
            <li><a href="/FsShelter/wordcount.html#Defining-unreliable-spouts">Spout</a></li>
			<li><a href="/FsShelter/wordcount.html#Defining-bolts">Bolt</a></li>
			<li><a href="/FsShelter/wordcount.html#Using-F-DSL-to-define-a-topology">Topology</a></li>
			<li><a href="/FsShelter/wordcount.html#Submitting-the-topology-for-execution">Submitting for execution</a></li>
            <li><a href="/FsShelter/wordcount.html#Exporting-the-topology-graph">Topology graph</a></li>
			</ul>
			</li>
              <li>
                  <a href="/FsShelter/guaranteed.html">Guaranteed processing</a>
                  <ul>
                      <li><a href="/FsShelter/guaranteed.html#Defining-reliable-spouts">Reliable Spout</a></li>
                      <li><a href="/FsShelter/guaranteed.html#Anchoring">Anchoring</a></li>
                  </ul>
              <li><a href="/FsShelter/schema.html">Schema considerations</a></li>
			</li>

            <li class="nav-header">Documentation</li>
            <li><a href="/FsShelter/reference/index.html">API Reference</a></li>
          </ul>
        </div>
      </div>
    </div>
    <a href="http://github.com/Prolucid/FsShelter"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"/></a>
  </body>
  </html>
